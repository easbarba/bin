#!/usr/bin/env bash

# DEBUG SETTINGS
set -euo pipefail

BECOME=false
DISTRO="$(awk '/^NAME=/ { split($0,a,"="); print a[2] }' /etc/os-release)"

# * CHECKER
DEPS=(bash sudo zae qas rsync)
s-checkdeps "${DEPS[@]}"

# * OPTIONS
print_usage() {
    printf "Usage:
    -s      skip become tasks
"
}

while getopts ':b' flag; do
    case "${flag}" in
        b) BECOME=true ;;
        *)
            print_usage
            exit 1
            ;;
    esac
done

# * SYSTEM
[[ $BECOME != true && -x $(command -v zae) ]] && zae update && zae upgrade

# * FOREIGN
s-distro-guix
s-distro-flatpak
s-distro-misc

# * USB-STICK
rsync -vhazrtP --ignore-existing /da/livros "/media/$USER/MOAR/"
